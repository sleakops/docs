---
sidebar_position: 3
title: "Despliegue Multi-Proyecto con GitHub Actions"
description: "Configura GitHub Actions para desplegar automáticamente múltiples proyectos SleakOps"
date: "2025-01-15"
category: "proyecto"
tags:
  ["github-actions", "ci-cd", "despliegue", "automatización", "sleakops-cli"]
---

import TroubleshootingItem from "@site/src/components/HomepageFeatures/troubleshootingitem";

# Despliegue Multi-Proyecto con GitHub Actions

**Fecha:** 15 de enero de 2025  
**Categoría:** Proyecto  
**Etiquetas:** GitHub Actions, CI/CD, Despliegue, Automatización, SleakOps CLI

## Descripción del Problema

**Contexto:** El usuario necesita configurar GitHub Actions para construir y desplegar automáticamente múltiples proyectos SleakOps al hacer push en la rama de producción, específicamente desea desplegar simultáneamente los proyectos `simplee-drf-aws-cl` y `simplee-drf-aws-mx`.

**Síntomas Observados:**

- La pipeline actual de CI/CD solo despliega un proyecto
- Necesidad de activar despliegues de múltiples proyectos desde un solo push
- Requisito de duplicar comandos de build y deploy para proyectos adicionales
- Confusión con el parámetro de entorno (usando `-e main` en lugar de `-e dev`)

**Configuración Relevante:**

- Plataforma: GitHub Actions
- Comandos SleakOps CLI: `sleakops build` y `sleakops deploy`
- Proyectos: `simplee-drf-aws-cl`, `simplee-drf-aws-mx`
- Rama disparadora: rama `prod`
- Entorno: `dev` (no `main`)

**Condiciones de Error:**

- Parámetro de entorno incorrecto en el comando de despliegue
- Despliegue de un solo proyecto en vez de multi-proyecto
- Necesidad de optimizar el workflow para múltiples proyectos

## Solución Detallada

<TroubleshootingItem id="basic-multi-project-setup" summary="Configuración Básica Multi-Proyecto en GitHub Actions">

Así es como configurar GitHub Actions para desplegar múltiples proyectos SleakOps:

```yaml
name: Multi-Project CI/CD

on:
  push:
    branches:
      - prod

jobs:
  build:
    runs-on: ubuntu-latest
    strategy:
      matrix:
        project: ["simplee-drf-aws-cl", "simplee-drf-aws-mx"]
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Install SleakOps CLI
        run: pip install sleakops

      - name: Run SleakOps build for ${{ matrix.project }}
        env:
          SLEAKOPS_KEY: ${{ secrets.SLEAKOPS_KEY }}
        run: sleakops build -p ${{ matrix.project }} -b prod -w

  deploy:
    needs: [build]
    runs-on: ubuntu-latest
    strategy:
      matrix:
        project: ["simplee-drf-aws-cl", "simplee-drf-aws-mx"]
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Install SleakOps CLI
        run: pip install sleakops

      - name: Run SleakOps deploy for ${{ matrix.project }}
        env:
          SLEAKOPS_KEY: ${{ secrets.SLEAKOPS_KEY }}
        run: sleakops deploy -p ${{ matrix.project }} -e dev -w
```

</TroubleshootingItem>

<TroubleshootingItem id="sequential-deployment" summary="Enfoque de Despliegue Secuencial">

Si prefieres un despliegue secuencial (un proyecto tras otro), usa esta configuración:

```yaml
name: Sequential Multi-Project CI/CD

on:
  push:
    branches:
      - prod

jobs:
  build-and-deploy-cl:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Install SleakOps CLI
        run: pip install sleakops

      - name: Build simplee-drf-aws-cl
        env:
          SLEAKOPS_KEY: ${{ secrets.SLEAKOPS_KEY }}
        run: sleakops build -p simplee-drf-aws-cl -b prod -w

      - name: Deploy simplee-drf-aws-cl
        env:
          SLEAKOPS_KEY: ${{ secrets.SLEAKOPS_KEY }}
        run: sleakops deploy -p simplee-drf-aws-cl -e dev -w

  build-and-deploy-mx:
    runs-on: ubuntu-latest
    needs: [build-and-deploy-cl]
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Install SleakOps CLI
        run: pip install sleakops

      - name: Build simplee-drf-aws-mx
        env:
          SLEAKOPS_KEY: ${{ secrets.SLEAKOPS_KEY }}
        run: sleakops build -p simplee-drf-aws-mx -b prod -w

      - name: Deploy simplee-drf-aws-mx
        env:
          SLEAKOPS_KEY: ${{ secrets.SLEAKOPS_KEY }}
        run: sleakops deploy -p simplee-drf-aws-mx -e dev -w
```

</TroubleshootingItem>

<TroubleshootingItem id="environment-parameter-fix" summary="Uso Correcto del Parámetro de Entorno">

**Importante:** El parámetro de entorno en el comando deploy debe coincidir con el nombre del entorno en SleakOps, no con la rama git.

Errores comunes:

- ❌ `sleakops deploy -p nombre-del-proyecto -e main -w`
- ✅ `sleakops deploy -p nombre-del-proyecto -e dev -w`
- ✅ `sleakops deploy -p nombre-del-proyecto -e prod -w`

Para verificar el nombre de tu entorno:

1. Ve a tu consola de SleakOps
2. Navega a tu proyecto
3. Revisa la sección de entornos
4. Usa el nombre exacto del entorno en el parámetro `-e`

</TroubleshootingItem>

<TroubleshootingItem id="advanced-configuration" summary="Configuración Avanzada con Manejo de Errores">

Para entornos de producción, considera agregar manejo de errores y notificaciones:

```yaml
name: Production Multi-Project CI/CD

on:
  push:
    branches:
      - prod

jobs:
  build:
    runs-on: ubuntu-latest
    strategy:
      matrix:
        project: ["simplee-drf-aws-cl", "simplee-drf-aws-mx"]
      fail-fast: false
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Install SleakOps CLI
        run: pip install sleakops

      - name: Build ${{ matrix.project }}
        env:
          SLEAKOPS_KEY: ${{ secrets.SLEAKOPS_KEY }}
        run: |
          echo "Construyendo ${{ matrix.project }}..."
          sleakops build -p ${{ matrix.project }} -b prod -w
          echo "Build completado para ${{ matrix.project }}"

  deploy:
    needs: [build]
    runs-on: ubuntu-latest
    strategy:
      matrix:
        project: ["simplee-drf-aws-cl", "simplee-drf-aws-mx"]
      fail-fast: false
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Install SleakOps CLI
        run: pip install sle
```
