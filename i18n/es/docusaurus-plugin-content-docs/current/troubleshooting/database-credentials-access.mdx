---
sidebar_position: 3
title: "Acceso a Credenciales de Base de Datos en SleakOps"
description: "Cómo acceder a credenciales de base de datos almacenadas como secretos de Kubernetes"
date: "2024-12-19"
category: "dependency"
tags: ["base de datos", "credenciales", "secretos", "postgres", "vargroup"]
---

import TroubleshootingItem from "@site/src/components/HomepageFeatures/troubleshootingitem";

# Acceso a Credenciales de Base de Datos en SleakOps

**Fecha:** 19 de diciembre de 2024  
**Categoría:** Dependencia  
**Etiquetas:** Base de datos, Credenciales, Secretos, Postgres, VarGroup

## Descripción del Problema

**Contexto:** Los usuarios necesitan acceder a las credenciales de la base de datos (específicamente la contraseña del usuario dbMaster) para tareas administrativas como deshabilitar triggers y restauración de datos, pero la contraseña no es visible directamente en la interfaz de SleakOps.

**Síntomas Observados:**

- El nombre de usuario de la base de datos es visible pero la contraseña no se muestra
- Se requieren credenciales para operaciones administrativas en la base de datos
- La contraseña no está disponible en la interfaz de base de datos de SleakOps
- Necesario para tareas como gestión de triggers y restauración de datos

**Configuración Relevante:**

- Tipo de base de datos: PostgreSQL
- Usuario: dbMaster
- Almacenamiento: Secreto de Kubernetes en el clúster
- Patrón de nombre del secreto: `{dbName}-postgres`
- Ubicación: Namespace del proyecto

**Condiciones de Error:**

- No se pueden realizar tareas administrativas en la base de datos sin las credenciales
- La contraseña no se muestra en la interfaz estándar de SleakOps
- Se necesita acceso en múltiples entornos (desarrollo, staging, producción)

## Solución Detallada

<TroubleshootingItem id="credential-storage" summary="Entendiendo el almacenamiento de credenciales en SleakOps">

SleakOps no almacena las contraseñas de base de datos en su propia base de datos por razones de seguridad. En cambio, las credenciales se almacenan como Secretos de Kubernetes dentro de tu clúster:

- **Ubicación de almacenamiento**: Secreto de Kubernetes en el namespace del proyecto
- **Formato del nombre del secreto**: `{dbName}-postgres`
- **Seguridad**: Sigue las mejores prácticas de gestión de secretos de Kubernetes
- **Acceso**: Disponible a través de la interfaz de edición de VarGroup

</TroubleshootingItem>

<TroubleshootingItem id="access-via-vargroup" summary="Accediendo a credenciales a través de VarGroup">

Para ver las credenciales de base de datos en SleakOps:

1. **Navega a tu proyecto**
2. **Ve a la sección VarGroup**
3. **Haz clic en "Editar" en el VarGroup correspondiente**
4. **Visualiza las credenciales**: SleakOps obtiene el secreto del clúster y lo muestra

```bash
# La estructura del secreto típicamente es:
apiVersion: v1
kind: Secret
metadata:
  name: {dbName}-postgres
  namespace: {project-namespace}
data:
  username: <usuario-codificado-en-base64>
  password: <contraseña-codificada-en-base64>
```

</TroubleshootingItem>

<TroubleshootingItem id="direct-cluster-access" summary="Acceso directo vía kubectl (método alternativo)">

Si tienes acceso al clúster, puedes obtener las credenciales directamente:

```bash
# Listar secretos en el namespace del proyecto
kubectl get secrets -n {project-namespace}

# Obtener el secreto específico de la base de datos
kubectl get secret {dbName}-postgres -n {project-namespace} -o yaml

# Decodificar la contraseña directamente
kubectl get secret {dbName}-postgres -n {project-namespace} -o jsonpath='{.data.password}' | base64 --decode
```

**Nota**: Este método requiere acceso kubectl a tu clúster.

</TroubleshootingItem>

<TroubleshootingItem id="multiple-environments" summary="Gestionando credenciales a través de entornos">

Para acceder a las credenciales en diferentes entornos:

1. **Entorno de Desarrollo**:

   - Navega al proyecto de desarrollo
   - Sigue el proceso de edición de VarGroup

2. **Staging/Producción**:
   - Repite el mismo proceso para cada entorno
   - Cada entorno tiene su propio namespace y secretos
   - Los nombres de los secretos siguen el mismo patrón: `{dbName}-postgres`

```bash
# Ejemplo para diferentes entornos
# Desarrollo
kubectl get secret myapp-postgres -n myproject-dev

# Staging
kubectl get secret myapp-postgres -n myproject-staging

# Producción
kubectl get secret myapp-postgres -n myproject-prod
```

</TroubleshootingItem>

<TroubleshootingItem id="administrative-tasks" summary="Uso de credenciales para tareas administrativas">

Una vez que tienes las credenciales, puedes usarlas para:

**Conexión a la Base de Datos**:

```bash
# Conectarse a PostgreSQL
psql -h {database-host} -U dbMaster -d {database-name}
```

**Tareas Administrativas Comunes**:

```sql
-- Deshabilitar triggers
ALTER TABLE {table_name} DISABLE TRIGGER ALL;

-- Habilitar triggers
ALTER TABLE {table_name} ENABLE TRIGGER ALL;

-- Crear respaldo de base de datos
pg_dump -h {host} -U dbMaster {database_name} > backup.sql

-- Restaurar base de datos
psql -h {host} -U dbMaster {database_name} < backup.sql
```

</TroubleshootingItem>

<TroubleshootingItem id="security-considerations" summary="Buenas prácticas de seguridad">

**Notas Importantes de Seguridad**:

- Las credenciales se almacenan de forma segura como Secretos de Kubernetes
- El acceso está controlado a través de permisos del proyecto en SleakOps
- Nunca almacenar credenciales en archivos de texto plano
- Usar credenciales específicas para cada entorno
- Rotar contraseñas regularmente

**Control de Acceso**:

- Solo usuarios con acceso al proyecto pueden ver las credenciales
- La edición de VarGroup requiere permisos adecuados
- El acceso al clúster está restringido a usuarios autorizados

</TroubleshootingItem>

---

_Esta FAQ fue generada automáticamente el 19 de diciembre de 2024 basada en una consulta real de usuario._
