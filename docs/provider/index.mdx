import Zoom from "react-medium-image-zoom";
import "react-medium-image-zoom/dist/styles.css";
import { FiExternalLink } from "react-icons/fi";

# Providers

## What is a provider?

The Provider is the first step to start on SleakOps after you've created your company. As well as in every case, when someone wants to start up its infrastructure it needs to decide which one of all the cloud infrastructure providers to use based on different pros and cons that each one has. Here, we are talking exactly about that, a provider is the cloud provider that you want, it can be AWS, Azure or GCP.

Next to this, you have to create the provider so SleakOps need access to this provider through credentials. This starts the process of generating different infrastructure resources and services that are needed to replicate the Architecture Reference Schema presented for that Cloud Provider. In this case, we will describe the construction of the presented [AWS Reference Architecture](/docs/provider/aws.mdx).

## Building process and required resources

<Zoom overlayBgColorEnd="rgba(255, 255, 255, 0.8)">
  <img
    src="/img/provider/aws/craftech-reference-architecture.png"
    alt="craftech-reference-architecture"
  />
</Zoom>

The first thing that we see in the architecture is the distribution of three [Accounts <FiExternalLink/>](https://aws.amazon.com/organizations/) (_mgt_, _dev_ and _prod_), following the creation flow, these are the resources that are initially created. Once the Accounts are up, we set to each one of them what we call Network Module, it contains a lot of different AWS services that are used to make the network connections inside accounts, it's extensive so let's dive in on what it creates:

- [Virtual Private Cloud (VPC) <FiExternalLink/>](https://aws.amazon.com/vpc/): Needed because inside it is where we build our infrastructure and a big part of its connections.
- [Internet Gateway (IGW) <FiExternalLink/>](https://docs.aws.amazon.com/vpc/latest/userguide/VPC_Internet_Gateway.html): The door of the VPC that allows us to access the resources inside it.
- [Elastic IP (Eip) <FiExternalLink/>](https://docs.aws.amazon.com/vpc/latest/userguide/vpc-eips.html): The IP related to the Internet Gateway.
- [Route Tables <FiExternalLink/>](https://docs.aws.amazon.com/vpc/latest/userguide/VPC_Route_Tables.html): As you can assume by analyzing the schema, we make three, the Public, the Private and the Persistence Route Tables.
- [Subnets <FiExternalLink/>](https://docs.aws.amazon.com/vpc/latest/userguide/configure-subnets.html): Similar to Route Tables. We create a Public Subnet, a Private Subnet and a Persistence Subnet. After this, the subnets are associated with their respective Route Tables via a [Route Table Association <FiExternalLink/>](https://docs.aws.amazon.com/vpc/latest/userguide/VPC_Route_Tables.html#route-table-assocation).
- [Route <FiExternalLink/>](https://docs.aws.amazon.com/vpc/latest/userguide/VPC_Route_Tables.html#route-table-routes): It's applied on network traffic resources like an Internet Gateway and a NatGateway, for Public and Private Route Tables respectively. Specifies a route in a Route Table within a VPC.
- [NatGateway <FiExternalLink/>](https://docs.aws.amazon.com/vpc/latest/userguide/vpc-nat-gateway.html): Allow resources on a private subnet to connect to services outside of the VPC, but negate traffic into this subnet.

Now we establish the connection between the accounts with [VPC Peering connections <FiExternalLink/>](https://docs.aws.amazon.com/vpc/latest/peering/what-is-vpc-peering.html), in the _mgt_ account we use a Network Peering Connection that works as the Requester while in the other accounts we need the Network Peering Accepter. All these cases need a Route for the traffic.

When generating these connections we also create the [Pritunl <FiExternalLink/>](https://pritunl.com/) VPN on _mgt_. For this, we use an [EC2 instance <FiExternalLink/>](https://aws.amazon.com/ec2/) that contains the VPN Server and configure three [Security Group Rules <FiExternalLink/>](https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html#SecurityGroupRules) to the [Security Group <FiExternalLink/>](https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html) to regulate the traffic.

Another difference between the networking on these organizations is that on the 'prod' account we also create a [HostedZone](/docs/provider/hostedzone.mdx).
