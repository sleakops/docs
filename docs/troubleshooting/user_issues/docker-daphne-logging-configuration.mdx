---
sidebar_position: 3
title: "Docker Logging Configuration for Daphne Applications"
description: "How to configure Docker containers to capture and display Daphne application logs"
date: "2025-01-21"
category: "workload"
tags: ["docker", "daphne", "logging", "django", "troubleshooting"]
---

import TroubleshootingItem from "@site/src/components/HomepageFeatures/troubleshootingitem";

# Docker Logging Configuration for Daphne Applications

**Date:** January 21, 2025  
**Category:** Workload  
**Tags:** Docker, Daphne, Logging, Django, Troubleshooting

## Problem Description

**Context:** User needs to configure a Docker container running a Django application with Daphne ASGI server to properly capture and display application logs through Docker's logging system.

**Observed Symptoms:**

- Application logs are not visible in Docker container logs
- Daphne server logs are not being captured by Docker
- Standard Docker logging parameters (`stdin_open: true`, `tty: true`) are not sufficient
- Application has logging configured but output is not reaching Docker's stdout

**Relevant Configuration:**

- Application: Django with Daphne ASGI server
- Container orchestration: Docker Compose
- Current parameters: `stdin_open: true` and `tty: true`
- Logger configured for Daphne in the application

**Error Conditions:**

- Logs are generated by the application but not visible in Docker logs
- Standard Docker logging configuration is insufficient for Daphne
- Need to redirect application logs to Docker's stdout/stderr streams

## Detailed Solution

<TroubleshootingItem id="redirect-logs-stdout" summary="Redirect Daphne logs to stdout">

The primary solution is to configure Daphne to output logs directly to `/dev/stdout`, which Docker can capture:

**Method 1: Command line configuration**

```dockerfile
# In your Dockerfile or docker-compose.yml command
CMD ["daphne", "-b", "0.0.0.0", "-p", "8000", "--access-log", "/dev/stdout", "--proxy-headers", "myproject.asgi:application"]
```

**Method 2: Environment variable**

```yaml
# docker-compose.yml
services:
  web:
    environment:
      - DAPHNE_ACCESS_LOG=/dev/stdout
      - DAPHNE_ERROR_LOG=/dev/stderr
```

</TroubleshootingItem>

<TroubleshootingItem id="django-logging-config" summary="Configure Django logging settings">

Update your Django `settings.py` to ensure logs are directed to stdout:

```python
# settings.py
LOGGING = {
    'version': 1,
    'disable_existing_loggers': False,
    'formatters': {
        'verbose': {
            'format': '{levelname} {asctime} {module} {process:d} {thread:d} {message}',
            'style': '{',
        },
        'simple': {
            'format': '{levelname} {message}',
            'style': '{',
        },
    },
    'handlers': {
        'console': {
            'class': 'logging.StreamHandler',
            'stream': 'ext://sys.stdout',
            'formatter': 'verbose',
        },
        'daphne': {
            'class': 'logging.StreamHandler',
            'stream': 'ext://sys.stdout',
            'formatter': 'verbose',
        },
    },
    'root': {
        'handlers': ['console'],
        'level': 'INFO',
    },
    'loggers': {
        'daphne': {
            'handlers': ['daphne'],
            'level': 'INFO',
            'propagate': False,
        },
        'django': {
            'handlers': ['console'],
            'level': 'INFO',
            'propagate': False,
        },
    },
}
```

</TroubleshootingItem>

<TroubleshootingItem id="docker-compose-configuration" summary="Complete docker-compose.yml configuration">

Here's a complete example of how to configure your `docker-compose.yml`:

```yaml
version: "3.8"

services:
  web:
    build: .
    ports:
      - "8000:8000"
    environment:
      - DEBUG=1
      - PYTHONUNBUFFERED=1 # Important for real-time log output
    command: >
      daphne 
      --bind 0.0.0.0 
      --port 8000 
      --access-log /dev/stdout 
      --proxy-headers 
      myproject.asgi:application
    logging:
      driver: "json-file"
      options:
        max-size: "10m"
        max-file: "3"
    # Remove these if not needed for your use case
    # stdin_open: true
    # tty: true
```

</TroubleshootingItem>

<TroubleshootingItem id="dockerfile-optimization" summary="Dockerfile optimizations for logging">

Optimize your Dockerfile for better logging:

```dockerfile
FROM python:3.11-slim

# Set environment variables for better logging
ENV PYTHONUNBUFFERED=1
ENV PYTHONDONTWRITEBYTECODE=1

WORKDIR /app

# Copy requirements and install dependencies
COPY requirements.txt .
RUN pip install --no-cache-dir -r requirements.txt

# Copy application code
COPY . .

# Create a non-root user
RUN useradd --create-home --shell /bin/bash app
USER app

# Expose port
EXPOSE 8000

# Start Daphne with proper logging
CMD ["daphne", "-b", "0.0.0.0", "-p", "8000", "--access-log", "/dev/stdout", "--proxy-headers", "myproject.asgi:application"]
```

</TroubleshootingItem>

<TroubleshootingItem id="troubleshooting-tips" summary="Troubleshooting and verification">

**Verify logs are working:**

```bash
# View container logs
docker-compose logs -f web

# Or for a specific container
docker logs -f <container_name>
```

**Common issues and solutions:**

1. **Logs still not appearing**: Ensure `PYTHONUNBUFFERED=1` is set
2. **Partial logs**: Check if your application is using print statements instead of proper logging
3. **Performance issues**: Consider using structured logging (JSON format)

**Test logging configuration:**

```python
# Add this to your Django views or management commands
import logging
logger = logging.getLogger(__name__)

def test_view(request):
    logger.info("Test log message from Django view")
    return HttpResponse("Check Docker logs for the message")
```

**Advanced logging with structured output:**

```python
# For JSON structured logs
LOGGING = {
    'version': 1
```
