"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[7180],{507:(e,t,i)=>{i.r(t),i.d(t,{assets:()=>d,contentTitle:()=>r,default:()=>c,frontMatter:()=>s,metadata:()=>l,toc:()=>h});var n=i(4848),o=i(8453),a=i(2644);const s={},r="Initial image build",l={id:"project/build/initial-build",title:"Initial image build",description:"Why do we only automate the first build?",source:"@site/docs/project/build/initial-build.mdx",sourceDirName:"project/build",slug:"/project/build/initial-build",permalink:"/project/build/initial-build",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Build",permalink:"/project/build/"},next:{title:"More on Build",permalink:"/project/build/more_on_build"}},d={},h=[{value:"Why do we only automate the first build?",id:"why-do-we-only-automate-the-first-build",level:2},{value:"How and when does Sleakops builds the image?",id:"how-and-when-does-sleakops-builds-the-image",level:3},{value:"Summary of resources created in the cluster",id:"summary-of-resources-created-in-the-cluster",level:2}];function u(e){const t={a:"a",admonition:"admonition",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",ul:"ul",...(0,o.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t.header,{children:(0,n.jsx)(t.h1,{id:"initial-image-build",children:"Initial image build"})}),"\n",(0,n.jsx)(t.h2,{id:"why-do-we-only-automate-the-first-build",children:"Why do we only automate the first build?"}),"\n",(0,n.jsx)(t.p,{children:"We make a first build of the image to deploy your apps faster, as we take advantage of the already active infrastructure. New images are built when services are published in deployments."}),"\n",(0,n.jsx)(t.admonition,{title:"Info: CLI Tool",type:"info",children:(0,n.jsxs)(t.p,{children:["Builds and Deployments can be automated with our CLI tool. More info ",(0,n.jsx)(t.a,{href:"/cli",children:"here"}),"."]})}),"\n",(0,n.jsx)(t.h3,{id:"how-and-when-does-sleakops-builds-the-image",children:"How and when does Sleakops builds the image?"}),"\n",(0,n.jsx)(t.p,{children:"When a project is created, you need to point to a path within the git repository where the Dockerfile is.\nSleakops scans the Dockerfile in search of arguments that are necessary for the build and asks you for values to make this first build.\nThe project list indicates the state of every project, and whether some extra information is required.\nThe values you provide for this initial build aren't meant to be permanent and can be modified for future builds."}),"\n",(0,n.jsxs)(t.p,{children:["The first image is built once the ProjectEnv is created, other images should be created on-demand by the user. You should know that SleakOps will always use the last commit to make a Build unless you set the specific commit but to do this you have to manage it creating a Build manually on the Build form, for more info read ",(0,n.jsx)(t.a,{href:"/project/build/",children:"Build documentation"}),".\nWhen you have provided all the arguments for the Dockerfile, a Kubernetes job is launched, along with a persistent volume for storage and the corresponding authentication secrets."]}),"\n",(0,n.jsxs)(t.p,{children:["Finally, the image is pushed to the ECR of the project, which is hosted in an ",(0,n.jsxs)(t.a,{href:"https://aws.amazon.com/ecr/",children:["AWS ECR ",(0,n.jsx)(a.HaR,{})]})," as described on the ",(0,n.jsx)(t.a,{href:"/project/",children:"Project documentation "}),". The resulting image has the ProjectEnv name which will be a combination of both Environment name and Project name."]}),"\n",(0,n.jsx)(t.h2,{id:"summary-of-resources-created-in-the-cluster",children:"Summary of resources created in the cluster"}),"\n",(0,n.jsx)(t.p,{children:"As previously discussed when the Kaniko job is launched, all the resources listed below are also created inside the respective cluster:"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsx)(t.li,{children:"A cluster secret containing the ECR credentials needed to push the image."}),"\n",(0,n.jsx)(t.li,{children:"A persistent volume for the Kaniko tasks to store the context it needs."}),"\n",(0,n.jsx)(t.li,{children:"The respective persistent volume claim."}),"\n",(0,n.jsx)(t.li,{children:"The job itself."}),"\n"]})]})}function c(e={}){const{wrapper:t}={...(0,o.R)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(u,{...e})}):u(e)}}}]);