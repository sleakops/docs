"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[6923],{7032:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>d,contentTitle:()=>l,default:()=>j,frontMatter:()=>c,metadata:()=>n,toc:()=>h});const n=JSON.parse('{"id":"django-celery","title":"Django + Celery","description":"Learn how to deploy your Django + Celery project with distributed and scalable worker mode on Kubernetes using Sleakops","source":"@site/tutorials/django-celery.mdx","sourceDirName":".","slug":"/django-celery","permalink":"/tutorial/django-celery","draft":false,"unlisted":false,"tags":[{"inline":true,"label":"django","permalink":"/tutorial/tags/django"},{"inline":true,"label":"celery","permalink":"/tutorial/tags/celery"},{"inline":true,"label":"deploy","permalink":"/tutorial/tags/deploy"},{"inline":true,"label":"python","permalink":"/tutorial/tags/python"},{"inline":true,"label":"background-jobs","permalink":"/tutorial/tags/background-jobs"},{"inline":true,"label":"kubernetes","permalink":"/tutorial/tags/kubernetes"},{"inline":true,"label":"scaling","permalink":"/tutorial/tags/scaling"}],"version":"current","sidebarPosition":10,"frontMatter":{"title":"Django + Celery","sidebar_label":"Django + Celery","sidebar_position":10,"description":"Learn how to deploy your Django + Celery project with distributed and scalable worker mode on Kubernetes using Sleakops","tags":["django","celery","deploy","python","background-jobs","kubernetes","scaling"],"image":"/img/tutorials/django-celery/django-celery.png"},"sidebar":"tutorialsSidebar","previous":{"title":"S3 Replication","permalink":"/tutorial/s3-replication"}}');var i=r(74848),o=r(28453),a=r(34028),s=(r(26393),r(42644));const c={title:"Django + Celery",sidebar_label:"Django + Celery",sidebar_position:10,description:"Learn how to deploy your Django + Celery project with distributed and scalable worker mode on Kubernetes using Sleakops",tags:["django","celery","deploy","python","background-jobs","kubernetes","scaling"],image:"/img/tutorials/django-celery/django-celery.png"},l=void 0,d={},h=[{value:"Prerequisites",id:"prerequisites",level:2},{value:"Let&#39;s Start",id:"lets-start",level:2},{value:"Create a project",id:"create-a-project",level:3},{value:"Create a Web Service",id:"create-a-web-service",level:3},{value:"Deploy celery worker",id:"deploy-celery-worker",level:3},{value:"Create a migration hook",id:"create-a-migration-hook",level:3},{value:"Create a collect static hook",id:"create-a-collect-static-hook",level:3},{value:"Create a Postgresql Database",id:"create-a-postgresql-database",level:3},{value:"Create S3 Bucket",id:"create-s3-bucket",level:3},{value:"Create Rabbitmq",id:"create-rabbitmq",level:3},{value:"Create your environment variables",id:"create-your-environment-variables",level:3},{value:"Deployments",id:"deployments",level:3},{value:"Optional",id:"optional",level:2},{value:"CI with Github",id:"ci-with-github",level:3}];function g(e){const t={a:"a",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,o.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.p,{children:"Learn how to deploy your Django + Celery project using Sleakops."}),"\n",(0,i.jsx)(t.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:"Account in Sleakops"}),"\n",(0,i.jsxs)(t.li,{children:["A Cluster in this account. If you don't have it, ",(0,i.jsx)(t.a,{href:"/docs/cluster",children:"here is the documentation on how to do it"}),"."]}),"\n",(0,i.jsxs)(t.li,{children:["An Environment configured. If you don't have it, ",(0,i.jsx)(t.a,{href:"/docs/environment",children:"here is the documentation on how to do it"})]}),"\n",(0,i.jsx)(t.li,{children:"Django project configured with celery (This project needs to have docker)."}),"\n"]}),"\n",(0,i.jsx)(t.h2,{id:"lets-start",children:"Let's Start"}),"\n",(0,i.jsxs)(t.p,{children:["For this example, we are going to use ",(0,i.jsxs)(t.a,{href:"https://github.com/sleakops/example-django-celery",children:["this project ",(0,i.jsx)(s.HaR,{})]}),". It is a Django project with Celery that already has Docker configured to run. We are also going to configure a Postgresql database, S3 bucket and Rabbitmq needed for this project."]}),"\n",(0,i.jsx)(t.h3,{id:"create-a-project",children:"Create a project"}),"\n",(0,i.jsx)(t.p,{children:'To start, we are going to create a new project. To do this, click the "Projects" button in the left panel:'}),"\n",(0,i.jsx)(a.A,{overlayBgColorEnd:"rgba(255, 255, 255, 0.8)",children:(0,i.jsx)("img",{src:"/img/quickstart/django_celery/click-project.png",alt:"click-project-reference"})}),"\n",(0,i.jsx)(t.p,{children:"Inside the Projects panel you will be able to see all the projects you have and manage them from here. We want to create a new one so let's click on the \u201ccreate\u201d button at the top right:"}),"\n",(0,i.jsx)(a.A,{overlayBgColorEnd:"rgba(255, 255, 255, 0.8)",children:(0,i.jsx)("img",{src:"/img/quickstart/django_celery/click-create-project.png",alt:"click-create-project-reference"})}),"\n",(0,i.jsx)(t.p,{children:"In the project creation screen we have the following fields:"}),"\n",(0,i.jsxs)(t.table,{children:[(0,i.jsx)(t.thead,{children:(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.th,{children:(0,i.jsx)(t.strong,{children:"Setting"})}),(0,i.jsx)(t.th,{children:(0,i.jsx)(t.strong,{children:"Description"})})]})}),(0,i.jsxs)(t.tbody,{children:[(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.strong,{children:"Environment"})}),(0,i.jsx)(t.td,{children:"We have to select the previously created environment."})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"Nodepool"}),(0,i.jsx)(t.td,{children:"We will leave the default one."})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.strong,{children:"Repositories"})}),(0,i.jsx)(t.td,{children:"We will select our repository that we want to deploy. In our case example-django-celery."})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"Project Name"}),(0,i.jsx)(t.td,{children:"We can define a project name. For the example we will leave the default."})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.strong,{children:"Branch"})}),(0,i.jsx)(t.td,{children:"It has to coincide with the one we have in our project. In our case it is \u201cMain\u201d."})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"Dockerfile path"}),(0,i.jsx)(t.td,{children:"It is the relative path to the dockerfile in your project."})]})]})]}),"\n",(0,i.jsx)(t.p,{children:"Once configured all that we create the project with the \u201cSubmit\u201d button at the bottom right:"}),"\n",(0,i.jsx)(a.A,{overlayBgColorEnd:"rgba(255, 255, 255, 0.8)",children:(0,i.jsx)("img",{src:"/img/quickstart/django_celery/create-project.png",alt:"create-project-reference"})}),"\n",(0,i.jsx)(t.p,{children:"With that, the project begins to be created. In the meantime we go to the workloads with the \u201cWorkloads\u201d button in the left panel:"}),"\n",(0,i.jsx)(a.A,{overlayBgColorEnd:"rgba(255, 255, 255, 0.8)",children:(0,i.jsx)("img",{src:"/img/quickstart/django_celery/click-workloads.png",alt:"click-workloads-reference"})}),"\n",(0,i.jsx)(t.h3,{id:"create-a-web-service",children:"Create a Web Service"}),"\n",(0,i.jsx)(t.p,{children:"Here what we are going to do is to create a web service so we go to the web service section and create one:"}),"\n",(0,i.jsx)(a.A,{overlayBgColorEnd:"rgba(255, 255, 255, 0.8)",children:(0,i.jsx)("img",{src:"/img/quickstart/django_celery/click-create-web-service.png",alt:"click-create-web-service-reference"})}),"\n",(0,i.jsx)(t.p,{children:"In this page we are going to complete the first form with the following fields:"}),"\n",(0,i.jsxs)(t.table,{children:[(0,i.jsx)(t.thead,{children:(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.th,{children:(0,i.jsx)(t.strong,{children:"Setting"})}),(0,i.jsx)(t.th,{children:(0,i.jsx)(t.strong,{children:"Description"})})]})}),(0,i.jsxs)(t.tbody,{children:[(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.strong,{children:"Project"})}),(0,i.jsx)(t.td,{children:"We select the project we created previously, in our case \u201cexample-django-celery\u201d."})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"Name"}),(0,i.jsx)(t.td,{children:"We define a name for the web service."})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.strong,{children:"Command"})}),(0,i.jsx)(t.td,{children:"By default this will take the value that is in the dockerfile, in our case this is fine."})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"Port"}),(0,i.jsx)(t.td,{children:"The same as the command."})]})]})]}),"\n",(0,i.jsx)(t.p,{children:"Then we continue by clicking on the \u201cNext\u201d button up to step 3:"}),"\n",(0,i.jsx)(a.A,{overlayBgColorEnd:"rgba(255, 255, 255, 0.8)",children:(0,i.jsx)("img",{src:"/img/quickstart/django_celery/create-web-service.png",alt:"create-web-service-reference"})}),"\n",(0,i.jsx)(t.p,{children:"In step 3 we have to edit the path field and put the endpoint of healthcheck\nwhich in our case is \u201c/healthcheck/\u201d. Then click on the \u201cNext\u201d button until the\nweb service is created:"}),"\n",(0,i.jsx)(a.A,{overlayBgColorEnd:"rgba(255, 255, 255, 0.8)",children:(0,i.jsx)("img",{src:"/img/quickstart/django_celery/create-web-service-2.png",alt:"create-web-service-2-reference"})}),"\n",(0,i.jsx)(t.h3,{id:"deploy-celery-worker",children:"Deploy celery worker"}),"\n",(0,i.jsx)(t.p,{children:"Well, with this we can see our web service deploying. Now we are going to deploy the celery. For this we have to go to the workers section inside the same workloads screen:"}),"\n",(0,i.jsx)(a.A,{overlayBgColorEnd:"rgba(255, 255, 255, 0.8)",children:(0,i.jsx)("img",{src:"/img/quickstart/django_celery/click-worker.png",alt:"click-worker-reference"})}),"\n",(0,i.jsx)(t.p,{children:"And click on the \u201cCreate\u201d button to create a new one:"}),"\n",(0,i.jsx)(a.A,{overlayBgColorEnd:"rgba(255, 255, 255, 0.8)",children:(0,i.jsx)("img",{src:"/img/quickstart/django_celery/click-create-worker.png",alt:"click-create-worker-reference"})}),"\n",(0,i.jsx)(t.p,{children:"In the workers creation screen we will have to complete the following fields:"}),"\n",(0,i.jsxs)(t.table,{children:[(0,i.jsx)(t.thead,{children:(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.th,{children:(0,i.jsx)(t.strong,{children:"Setting"})}),(0,i.jsx)(t.th,{children:(0,i.jsx)(t.strong,{children:"Description"})})]})}),(0,i.jsxs)(t.tbody,{children:[(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.strong,{children:"Project"})}),(0,i.jsx)(t.td,{children:"Select the previously created project. In our case \u201cexample-django-celery\u201d."})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"Name"}),(0,i.jsx)(t.td,{children:"We define the name that we are going to give to the worker. In our case \u201ccelery\u201d."})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.strong,{children:"Command"})}),(0,i.jsxs)(t.td,{children:["Here we set the command to run celery, in our case it is: ",(0,i.jsx)(t.code,{children:"bash celery -A core.celery_app worker -l INFO --concurrency 1 --max-tasks-per-child 1 --prefetch-multiplier 1 -n celery@%h --queues default,build,deployment,cluster,canvas,billing"})]})]})]})]}),"\n",(0,i.jsx)(t.p,{children:"With these fields filled in we will click on the \u201cNext\u201d button at the bottom right and then \u201cSubmit\u201d as we do not need to edit anything else:"}),"\n",(0,i.jsx)(a.A,{overlayBgColorEnd:"rgba(255, 255, 255, 0.8)",children:(0,i.jsx)("img",{src:"/img/quickstart/django_celery/create-worker.png",alt:"create-worker-reference"})}),"\n",(0,i.jsx)(t.p,{children:"With this we will see our celery published. Now we have to configure the hooks. For this we go to the hooks section:"}),"\n",(0,i.jsx)(a.A,{overlayBgColorEnd:"rgba(255, 255, 255, 0.8)",children:(0,i.jsx)("img",{src:"/img/quickstart/django_celery/click-hook.png",alt:"click-hook-reference"})}),"\n",(0,i.jsx)(t.h3,{id:"create-a-migration-hook",children:"Create a migration hook"}),"\n",(0,i.jsx)(t.p,{children:"In the hook creation screen we will have the following fields:"}),"\n",(0,i.jsxs)(t.table,{children:[(0,i.jsx)(t.thead,{children:(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.th,{children:(0,i.jsx)(t.strong,{children:"Setting"})}),(0,i.jsx)(t.th,{children:(0,i.jsx)(t.strong,{children:"Description"})})]})}),(0,i.jsxs)(t.tbody,{children:[(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.strong,{children:"Project"})}),(0,i.jsx)(t.td,{children:"Select the previously created project. In our case \u201cexample-django-celery\u201d."})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.strong,{children:"Name"})}),(0,i.jsx)(t.td,{children:"We define the name that we are going to give to the worker. In our case \u201cmigrations\u201d."})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.strong,{children:"Command"})}),(0,i.jsxs)(t.td,{children:["Here we set the command to run celery, in our case it is: ",(0,i.jsx)(t.code,{children:"bash python manage.py migrate --no-input "})]})]})]})]}),"\n",(0,i.jsx)(t.p,{children:"With these fields filled in we will click on the \u201cNext\u201d button at the bottom right and then \u201cSubmit\u201d as we do not need to edit anything else:"}),"\n",(0,i.jsx)(a.A,{overlayBgColorEnd:"rgba(255, 255, 255, 0.8)",children:(0,i.jsx)("img",{src:"/img/quickstart/django_celery/create-hook.png",alt:"create-hook-reference"})}),"\n",(0,i.jsx)(t.h3,{id:"create-a-collect-static-hook",children:"Create a collect static hook"}),"\n",(0,i.jsx)(t.p,{children:"Now we proceed to create another hook that we need for the statics:"}),"\n"," ","\n",(0,i.jsx)(a.A,{overlayBgColorEnd:"rgba(255, 255, 255, 0.8)",children:(0,i.jsx)("img",{src:"/img/quickstart/django_celery/click-create-collectstatic-hook.png",alt:"click-create-collectstatic-hook-reference"})}),"\n",(0,i.jsx)(t.p,{children:"In this form we are going to do the same as the previous one but modifying the command. We click next until we create the hook (without modifying anything else):"}),"\n",(0,i.jsx)(a.A,{overlayBgColorEnd:"rgba(255, 255, 255, 0.8)",children:(0,i.jsx)("img",{src:"/img/quickstart/django_celery/create-collectstatic-hook.png",alt:"create-collectstatic-hook-reference"})}),"\n",(0,i.jsx)(t.p,{children:"The command we use is as follows:"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-plain",children:"bash python manage.py collectstatic --no-input\n"})}),"\n",(0,i.jsx)(t.h3,{id:"create-a-postgresql-database",children:"Create a Postgresql Database"}),"\n",(0,i.jsx)(t.p,{children:"Once we have created the hooks we have to go to create our database. To do this we go to the \u201cDependencies\u201d section:"}),"\n",(0,i.jsx)(a.A,{overlayBgColorEnd:"rgba(255, 255, 255, 0.8)",children:(0,i.jsx)("img",{src:"/img/quickstart/django_celery/click-dependencies.png",alt:"click-dependencies-reference"})}),"\n",(0,i.jsx)(t.p,{children:"Inside this section we click on the \u201cCreate\u201d button at the top right and then select \u201cPostgresql\u201d:"}),"\n",(0,i.jsx)(a.A,{overlayBgColorEnd:"rgba(255, 255, 255, 0.8)",children:(0,i.jsx)("img",{src:"/img/quickstart/django_celery/click-create-dependencies.png",alt:"click-create-dependencies-reference"})}),"\n",(0,i.jsx)(a.A,{overlayBgColorEnd:"rgba(255, 255, 255, 0.8)",children:(0,i.jsx)("img",{src:"/img/quickstart/django_celery/click-postgresql.png",alt:"click-postgresql-reference"})}),"\n",(0,i.jsx)(t.p,{children:"In the 1st postgresql creation form we will have to select our previously created project and define a name for it, then click on the \u201cNext\u201d button at the bottom right:"}),"\n",(0,i.jsx)(a.A,{overlayBgColorEnd:"rgba(255, 255, 255, 0.8)",children:(0,i.jsx)("img",{src:"/img/quickstart/django_celery/create-postgresql.png",alt:"create-postgresql-reference"})}),"\n",(0,i.jsx)(t.p,{children:"In the 2nd form we are going to have a lot of fields, the only ones that matter to us are the following:"}),"\n",(0,i.jsxs)(t.table,{children:[(0,i.jsx)(t.thead,{children:(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.th,{children:(0,i.jsx)(t.strong,{children:"Setting"})}),(0,i.jsx)(t.th,{children:(0,i.jsx)(t.strong,{children:"Description"})})]})}),(0,i.jsxs)(t.tbody,{children:[(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.strong,{children:"Database Master Username"})}),(0,i.jsx)(t.td,{children:"Here we assign a root user name to our database."})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.strong,{children:"Database Master Password"})}),(0,i.jsx)(t.td,{children:"A password for this root user."})]})]})]}),"\n",(0,i.jsx)(t.p,{children:"With these fields filled in, we are ready to move on. Click on the \u201cNext\u201d button at the bottom right to proceed to the third form:"}),"\n",(0,i.jsx)(a.A,{overlayBgColorEnd:"rgba(255, 255, 255, 0.8)",children:(0,i.jsx)("img",{src:"/img/quickstart/django_celery/create-postgresql-2.png",alt:"create-postgresql-2-reference"})}),"\n",(0,i.jsx)(t.p,{children:"In this last form, we are going to adjust the environment variables we have in our project with respect to the database. To do this, we need to change the following variables to our own:"}),"\n",(0,i.jsxs)(t.table,{children:[(0,i.jsx)(t.thead,{children:(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.th,{children:(0,i.jsx)(t.strong,{children:"Before"})}),(0,i.jsx)(t.th,{children:(0,i.jsx)(t.strong,{children:"After"})})]})}),(0,i.jsxs)(t.tbody,{children:[(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"*_POSTGRESQL_NAME"}),(0,i.jsx)(t.td,{children:"DB_NAME"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"*_POSTGRESQL_USERNAME"}),(0,i.jsx)(t.td,{children:"DB_USER"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"*_POSTGRESQL_PASSWORD"}),(0,i.jsx)(t.td,{children:"DB_PASSWORD"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"*_POSTGRESQL_ADDRESS"}),(0,i.jsx)(t.td,{children:"DB_HOST"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"*_POSTGRESQL_PORT"}),(0,i.jsx)(t.td,{children:"DB_PORT"})]})]})]}),"\n",(0,i.jsx)(t.p,{children:"It should look something like the image below. Then click on the \u201cSubmit\u201d button and your database should be created:"}),"\n",(0,i.jsx)(a.A,{overlayBgColorEnd:"rgba(255, 255, 255, 0.8)",children:(0,i.jsx)("img",{src:"/img/quickstart/django_celery/create-postgresql-3.png",alt:"create-postgresql-3-reference"})}),"\n",(0,i.jsx)(t.h3,{id:"create-s3-bucket",children:"Create S3 Bucket"}),"\n",(0,i.jsx)(t.p,{children:"In the same page of dependencies we have to create our s3 bucket, for it we are going to go to the \u201cCreate\u201d button again:"}),"\n",(0,i.jsx)(a.A,{overlayBgColorEnd:"rgba(255, 255, 255, 0.8)",children:(0,i.jsx)("img",{src:"/img/quickstart/django_celery/click-create-s3-dependencies.png",alt:"click-create-s3-dependencies-reference"})}),"\n",(0,i.jsx)(t.p,{children:"And select S3 Bucket:"}),"\n",(0,i.jsx)(a.A,{overlayBgColorEnd:"rgba(255, 255, 255, 0.8)",children:(0,i.jsx)("img",{src:"/img/quickstart/django_celery/click-create-s3-dependencies-2.png",alt:"click-create-s3-dependencies-2-reference"})}),"\n",(0,i.jsx)(t.p,{children:"In the first form we have to select our previously created project and define a name for the bucket, we have to take into account that the name of the bucket is global so it has to be unique. Now click on the \u201cNext\u201d button and go to step 3:"}),"\n",(0,i.jsx)(a.A,{overlayBgColorEnd:"rgba(255, 255, 255, 0.8)",children:(0,i.jsx)("img",{src:"/img/quickstart/django_celery/create-s3-dependencies.png",alt:"create-s3-dependencies-reference"})}),"\n",(0,i.jsxs)(t.p,{children:["Here we are going to see some environment variables defined for the bucket. We are going to edit the one that says ",(0,i.jsx)(t.strong,{children:"COLLECTSTATICEXAMPLEDJANGOCELERY_BUCKET_NAME"})," and we are going to call it ",(0,i.jsx)(t.strong,{children:"DJANGO_AWS_STORAGE_BUCKET_NAME"}),". With this simple change we click on the \u201cSubmit\u201d button at the bottom right to finish creating the bucket:"]}),"\n",(0,i.jsx)(a.A,{overlayBgColorEnd:"rgba(255, 255, 255, 0.8)",children:(0,i.jsx)("img",{src:"/img/quickstart/django_celery/create-s3-dependencies-3.png",alt:"create-s3-dependencies-3-reference"})}),"\n",(0,i.jsx)(t.h3,{id:"create-rabbitmq",children:"Create Rabbitmq"}),"\n",(0,i.jsx)(t.p,{children:"Now we need one more dependency. Our Rabbitmq to queue celery tasks, so let's get to it:"}),"\n",(0,i.jsx)(a.A,{overlayBgColorEnd:"rgba(255, 255, 255, 0.8)",children:(0,i.jsx)("img",{src:"/img/quickstart/django_celery/click-create-rabbitmq-dependencies.png",alt:"click-create-rabbitmq-dependencies-reference"})}),"\n",(0,i.jsx)(t.p,{children:"And select Rabbitmq:"}),"\n",(0,i.jsx)(a.A,{overlayBgColorEnd:"rgba(255, 255, 255, 0.8)",children:(0,i.jsx)("img",{src:"/img/quickstart/django_celery/click-select-rabbitmq.png",alt:"click-select-rabbitmq-reference"})}),"\n",(0,i.jsx)(t.p,{children:"In the first form we will have to select our project and define a name for it.\nThen click on the \u201cNext\u201d button at the bottom right:"}),"\n",(0,i.jsx)(a.A,{overlayBgColorEnd:"rgba(255, 255, 255, 0.8)",children:(0,i.jsx)("img",{src:"/img/quickstart/django_celery/create-rabbitmq.png",alt:"create-rabbitmq-reference"})}),"\n",(0,i.jsx)(t.p,{children:"In the following form we have several fields but the only ones that matter to us\nfor this example are the username and password, we can define whatever we want.\nFor this example I chose admin as username and for the password I generated it\nrandomly with the dice button. Then we click on the \u201cNext\u201d button to go to the\nnext form:"}),"\n",(0,i.jsx)(a.A,{overlayBgColorEnd:"rgba(255, 255, 255, 0.8)",children:(0,i.jsx)("img",{src:"/img/quickstart/django_celery/create-rabbitmq-2.png",alt:"create-rabbitmq-2-reference"})}),"\n",(0,i.jsx)(t.p,{children:"In this last form we have to change the name of the variable that ends in *_BROKER_AUTH_URL to CELERY_BROKER_URL (as shown in the image). Then we click on the \u201cSubmit\u201d button at the bottom right to finish creating rabbitmq:"}),"\n",(0,i.jsx)(a.A,{overlayBgColorEnd:"rgba(255, 255, 255, 0.8)",children:(0,i.jsx)("img",{src:"/img/quickstart/django_celery/create-rabbitmq-3.png",alt:"create-rabbitmq-3-reference"})}),"\n",(0,i.jsx)(t.h3,{id:"create-your-environment-variables",children:"Create your environment variables"}),"\n",(0,i.jsxs)(t.p,{children:["Once the dependencies are deployed we have to configure our environment variables. We are going to go to the ",(0,i.jsx)(t.strong,{children:"Vargroups"})," section:"]}),"\n",(0,i.jsx)(a.A,{overlayBgColorEnd:"rgba(255, 255, 255, 0.8)",children:(0,i.jsx)("img",{src:"/img/quickstart/django_celery/click-vargroups.png",alt:"click-vargroups-reference"})}),"\n",(0,i.jsx)(t.p,{children:"Here you will see all your environment variables that you created grouped in groups, for example you should have created one with the data for the database (which is the one you see in the image). Now we are going to create another one for our django environment variables, for this we click on the \u201cCreate\u201d button at the top right:"}),"\n",(0,i.jsx)(a.A,{overlayBgColorEnd:"rgba(255, 255, 255, 0.8)",children:(0,i.jsx)("img",{src:"/img/quickstart/django_celery/click-create-vargroups.png",alt:"click-create-vargroups-reference"})}),"\n",(0,i.jsx)(t.p,{children:"In this form we have the following fields:"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:"Project: we select the project we created previously."}),"\n",(0,i.jsx)(t.li,{children:"Workload: We select \u201cglobal\u201d that makes reference to be used by all our workloads."}),"\n",(0,i.jsx)(t.li,{children:"Name: We define a name for this group of variables."}),"\n",(0,i.jsx)(t.li,{children:"Type: If we want to load it by file or by variable."}),"\n",(0,i.jsx)(t.li,{children:"Vars: Here we enable the textmode and copy the following environment variables:"}),"\n"]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-bash",children:"CELERY_RESULT_BACKEND=django-db\nDJANGO_ADMIN_URL=admin/\nDJANGO_DEBUG=False\nDJANGO_SECRET_KEY=secret_key\nDJANGO_SETTINGS_MODULE=core.settings.production\nDJANGO_STATIC_STORAGE=storages.backends.s3boto3.S3StaticStorage\nDB_ENGINE=django.db.backends.postgresql_psycopg2\nENVIRONMENT=production\nLOGS_LEVEL=INFO\nPYTHONPATH=.\n"})}),"\n",(0,i.jsx)(t.p,{children:"These environment variables are required for our example project. Finally click on the \u201cSubmit\u201d button at the bottom right to create the variable group."}),"\n",(0,i.jsx)(a.A,{overlayBgColorEnd:"rgba(255, 255, 255, 0.8)",children:(0,i.jsx)("img",{src:"/img/quickstart/django_celery/create-vargroup.png",alt:"create-vargroup-reference"})}),"\n",(0,i.jsx)(t.h3,{id:"deployments",children:"Deployments"}),"\n",(0,i.jsx)(t.p,{children:"As last step we are going to see our project deployed, for this we go to the \u201cDeployments\u201d section of the left panel:"}),"\n",(0,i.jsx)(a.A,{overlayBgColorEnd:"rgba(255, 255, 255, 0.8)",children:(0,i.jsx)("img",{src:"/img/quickstart/django_celery/click-deployments.png",alt:"click-deployments-reference"})}),"\n",(0,i.jsx)(t.p,{children:"Here we are going to see all the deploys that we do. In our case it is the first one and we can see that it has been created correctly, in case you see any error if you click on \u201cerror\u201d you can see a description of it.\nIf we do not see any error then it means that the project is already deployed, we could begin to use it from the url that the web service provided us."}),"\n",(0,i.jsx)(a.A,{overlayBgColorEnd:"rgba(255, 255, 255, 0.8)",children:(0,i.jsx)("img",{src:"/img/quickstart/django_celery/deployments.png",alt:"deployments-reference"})}),"\n",(0,i.jsx)(t.p,{children:"This concludes our project deployment process. We leave you an optional step\nwhich is to configure the ci with github."}),"\n",(0,i.jsx)(t.h2,{id:"optional",children:"Optional"}),"\n",(0,i.jsx)(t.h3,{id:"ci-with-github",children:"CI with Github"}),"\n",(0,i.jsx)(t.p,{children:"Every time you make a change in your code and want to deploy it you will have to do a build and a deploy, this eventually becomes tedious. That's why to avoid this we have to implement ci on github."}),"\n",(0,i.jsx)(t.p,{children:"For this we are going to go to \u201cProjects\u201d in the left panel:"}),"\n",(0,i.jsx)(a.A,{overlayBgColorEnd:"rgba(255, 255, 255, 0.8)",children:(0,i.jsx)("img",{src:"/img/quickstart/django_celery/click-project-2.png",alt:"click-project-2-reference"})}),"\n",(0,i.jsx)(t.p,{children:"Let's locate our project and click on the gear to access the project configuration:"}),"\n",(0,i.jsx)(a.A,{overlayBgColorEnd:"rgba(255, 255, 255, 0.8)",children:(0,i.jsx)("img",{src:"/img/quickstart/django_celery/click-settings-project.png",alt:"click-settings-project-reference"})}),"\n",(0,i.jsx)(t.p,{children:"In the project configuration we locate the one that says \u201cGit pipelines\u201d and click on it:"}),"\n",(0,i.jsx)(a.A,{overlayBgColorEnd:"rgba(255, 255, 255, 0.8)",children:(0,i.jsx)("img",{src:"/img/quickstart/django_celery/click-git-pipelines.png",alt:"click-git-pipelines-reference"})}),"\n",(0,i.jsx)(t.p,{children:"Here we are going to find what we need to do this. Basically we need to set up a file in the root of our project .github/workflows/ called ci_sleakops_demo.yml and in that file we are going to paste the content that appears in this page."}),"\n",(0,i.jsx)(a.A,{overlayBgColorEnd:"rgba(255, 255, 255, 0.8)",children:(0,i.jsx)("img",{src:"/img/quickstart/django_celery/git-pipelines.png",alt:"git-pipelines-reference"})}),"\n",(0,i.jsxs)(t.p,{children:["This needs to have an environment variable SLEAKOPS_KEY, if you don't have it you have to go to the link that appears there ",(0,i.jsx)(t.strong,{children:"Settings -> CLI"}),", get it and save it as an environment variable."]}),"\n",(0,i.jsx)(t.p,{children:"With this configured and deployed every time you do a push to your \u201cmain\u201d branch a new version of your application will be launched automatically."})]})}function j(e={}){const{wrapper:t}={...(0,o.R)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(g,{...e})}):g(e)}},26393:()=>{}}]);