"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[1403],{92376:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>d,contentTitle:()=>c,default:()=>g,frontMatter:()=>l,metadata:()=>i,toc:()=>p});const i=JSON.parse('{"id":"third-party-integration-vpn","title":"Integraci\xf3n VPN de Terceros","description":"Comparaci\xf3n de alternativas VPN en AWS","source":"@site/i18n/es/docusaurus-plugin-content-docs-tutorials/current/third-party-integration-vpn.mdx","sourceDirName":".","slug":"/third-party-integration-vpn","permalink":"/preview-docs/es/tutorial/third-party-integration-vpn","draft":false,"unlisted":false,"tags":[{"inline":true,"label":"VPN","permalink":"/preview-docs/es/tutorial/tags/vpn"},{"inline":true,"label":"AWS","permalink":"/preview-docs/es/tutorial/tags/aws"},{"inline":true,"label":"third-party","permalink":"/preview-docs/es/tutorial/tags/third-party"},{"inline":true,"label":"networking","permalink":"/preview-docs/es/tutorial/tags/networking"},{"inline":true,"label":"connectivity","permalink":"/preview-docs/es/tutorial/tags/connectivity"},{"inline":true,"label":"cost-analysis","permalink":"/preview-docs/es/tutorial/tags/cost-analysis"},{"inline":true,"label":"transit-gateway","permalink":"/preview-docs/es/tutorial/tags/transit-gateway"}],"version":"current","sidebarPosition":8,"frontMatter":{"sidebar_label":"Integraci\xf3n VPN de Terceros","sidebar_position":8,"title":"Integraci\xf3n VPN de Terceros","description":"Comparaci\xf3n de alternativas VPN en AWS","tags":["VPN","AWS","third-party","networking","connectivity","cost-analysis","transit-gateway"],"image":"/img/tutorials/third-party-integration-vpn/third-party-integration-vpn.png"},"sidebar":"tutorialsSidebar","previous":{"title":"S3 Batch","permalink":"/preview-docs/es/tutorial/s3-batch"},"next":{"title":"Replicaci\xf3n S3","permalink":"/preview-docs/es/tutorial/s3-replication"}}');var t=s(74848),r=s(28453),a=s(34028),o=(s(26393),s(42644));const l={sidebar_label:"Integraci\xf3n VPN de Terceros",sidebar_position:8,title:"Integraci\xf3n VPN de Terceros",description:"Comparaci\xf3n de alternativas VPN en AWS",tags:["VPN","AWS","third-party","networking","connectivity","cost-analysis","transit-gateway"],image:"/img/tutorials/third-party-integration-vpn/third-party-integration-vpn.png"},c=void 0,d={},p=[{value:"Transit Gateway (~197 USD/mes en el escenario descrito)",id:"transit-gateway-197-usdmes-en-el-escenario-descrito",level:3},{value:"Site-to-Site VPN + EC2 (~80 USD/mes estimados)",id:"site-to-site-vpn--ec2-80-usdmes-estimados",level:3},{value:"VPN on EC2 (StrongSwan + Nginx) (~20\u201321 USD/mes con 1 instancia, o ~40\u201342 USD/mes para HA)",id:"vpn-on-ec2-strongswan--nginx-2021-usdmes-con-1-instancia-o-4042-usdmes-para-ha",level:3},{value:"Transit Gateway",id:"transit-gateway",level:2},{value:"An\xe1lisis de costos",id:"an\xe1lisis-de-costos",level:3},{value:"VPN Site-to-Site",id:"vpn-site-to-site",level:2},{value:"An\xe1lisis de costos",id:"an\xe1lisis-de-costos-1",level:3},{value:"VPN on EC2",id:"vpn-on-ec2",level:2},{value:"An\xe1lisis de costos",id:"an\xe1lisis-de-costos-2",level:3}];function h(e){const n={a:"a",code:"code",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(n.p,{children:["La elecci\xf3n entre estas tres alternativas se basa en el equilibrio entre ",(0,t.jsx)(n.strong,{children:"costos"}),", ",(0,t.jsx)(n.strong,{children:"escalabilidad"})," y ",(0,t.jsx)(n.strong,{children:"complejidad de gesti\xf3n"}),":"]}),"\n",(0,t.jsx)(n.h3,{id:"transit-gateway-197-usdmes-en-el-escenario-descrito",children:"Transit Gateway (~197 USD/mes en el escenario descrito)"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Mayor costo fijo por attachment."}),"\n",(0,t.jsx)(n.li,{children:"Excelente opci\xf3n para topolog\xedas m\xe1s grandes, m\xfaltiples VPCs y escalabilidad con m\xednima complejidad de routing."}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"site-to-site-vpn--ec2-80-usdmes-estimados",children:"Site-to-Site VPN + EC2 (~80 USD/mes estimados)"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Facilidad de configuraci\xf3n (soluci\xf3n nativa de AWS)."}),"\n",(0,t.jsx)(n.li,{children:"Adecuada para un n\xfamero moderado de t\xfaneles, aunque menos flexible que TGW para grandes topolog\xedas."}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"vpn-on-ec2-strongswan--nginx-2021-usdmes-con-1-instancia-o-4042-usdmes-para-ha",children:"VPN on EC2 (StrongSwan + Nginx) (~20\u201321 USD/mes con 1 instancia, o ~40\u201342 USD/mes para HA)"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Coste significativamente m\xe1s bajo."}),"\n",(0,t.jsx)(n.li,{children:"Mayor complejidad de administraci\xf3n y mantenimiento (gesti\xf3n de instancia, parches, failover manual)."}),"\n",(0,t.jsx)(n.li,{children:"Adecuada si el tr\xe1fico total es bajo y si se cuenta con personal para operar/monitorizar la instancia."}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"transit-gateway",children:"Transit Gateway"}),"\n",(0,t.jsx)(n.p,{children:"Act\xfaa como un enrutador centralizado que permite la interconexi\xf3n entre m\xfaltiples VPCs, redes on-premises y redes de terceros."}),"\n",(0,t.jsx)(n.p,{children:"Las conexiones VPN se establecen a trav\xe9s de t\xfaneles IPsec, que pueden configurarse para ofrecer alta disponibilidad y redundancia (generalmente se configuran dos t\xfaneles por conexi\xf3n VPN para lograr failover autom\xe1tico)."}),"\n",(0,t.jsx)(a.A,{overlayBgColorEnd:"rgba(255, 255, 255, 0.8)",children:(0,t.jsx)("img",{src:"/img/tutorials/third-party-integration-vpn/vpn.png",alt:"vpn"})}),"\n",(0,t.jsx)(n.h3,{id:"an\xe1lisis-de-costos",children:"An\xe1lisis de costos"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Hip\xf3tesis:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"3 attachments"})," en el Transit Gateway, que corresponden por ejemplo a:","\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsx)(n.li,{children:"VPC (Dev)"}),"\n",(0,t.jsx)(n.li,{children:"VPN (Prod)"}),"\n",(0,t.jsx)(n.li,{children:"VPN (Contingency)"}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"730 horas"})," de uso mensuales (24/7)."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"2 GB de transferencia mensual"})," por cada attachment, totalizando ",(0,t.jsx)(n.strong,{children:"6 GB mensuales"}),"."]}),"\n",(0,t.jsxs)(n.li,{children:["Tarifas de AWS (en la mayor\xeda de las regiones):","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"0.09 USD/hora/attachment"}),"."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"0.002 USD/GB"})," de transferencia de datos."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Costos:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Costo attachments"}),": ~197.10 USD/mes"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Costo data transfer"}),": ~0.01 USD/mes"]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Suma total"}),": ~197.11 USD/mes (se redondea a ~197.22 USD/mes en el ejemplo original)."]}),"\n",(0,t.jsx)(n.h2,{id:"vpn-site-to-site",children:"VPN Site-to-Site"}),"\n",(0,t.jsxs)(n.p,{children:["Una conexi\xf3n de Site-to-Site VPN ofrece dos t\xfaneles de VPN entre una virtual ",(0,t.jsx)(n.strong,{children:"private gateway"})," o una ",(0,t.jsx)(n.strong,{children:"transit gateway"})," del lado de AWS y una ",(0,t.jsx)(n.strong,{children:"customer gateway"})," en el lado remoto (on-premise)."]}),"\n",(0,t.jsxs)(n.p,{children:["Dos t\xfaneles para automatic failover o mantenimientos que suele hacer AWS que podr\xedan deshabilitar brevemente uno de los t\xfaneles \u2014> ",(0,t.jsx)(o.HaR,{})," ",(0,t.jsx)(n.a,{href:"https://docs.aws.amazon.com/vpn/latest/s2svpn/endpoint-replacements.html",children:"Site-to-Site VPN tunnel endpoint replacement"})]}),"\n",(0,t.jsx)(a.A,{overlayBgColorEnd:"rgba(255, 255, 255, 0.8)",children:(0,t.jsx)("img",{src:"/img/tutorials/third-party-integration-vpn/vpn-2.png",alt:"vpn-2"})}),"\n",(0,t.jsx)(a.A,{overlayBgColorEnd:"rgba(255, 255, 255, 0.8)",children:(0,t.jsx)("img",{src:"/img/tutorials/third-party-integration-vpn/vpn-3.png",alt:"vpn-3"})}),"\n",(0,t.jsx)(n.h3,{id:"an\xe1lisis-de-costos-1",children:"An\xe1lisis de costos"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Hip\xf3tesis:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"3 conexiones (VPN)"}),' (equivalentes a los 3 "attachments" que mencionaste: Dev, Main, Contingencia).']}),"\n",(0,t.jsx)(n.li,{children:"Cada VPN es un t\xfanel Site-to-Site gestionado por AWS."}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Costo de Site-to-Site VPN"}),": 0.05 USD por hora por VPN"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"730 horas"})," mensuales (24/7)."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"2 GB de transferencia mensual"})," por cada VPN."]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Costos:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"VPN"})," (3 conexiones): ~109.50 USD"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Transferencia de datos"})," (6 GB total): ~0.54 USD"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Network Load Balancer"}),": ~20\u201325 USD"]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Suma total"}),": ~130\u2013135 USD mensuales."]}),"\n",(0,t.jsx)(n.h2,{id:"vpn-on-ec2",children:"VPN on EC2"}),"\n",(0,t.jsxs)(n.p,{children:["En esta soluci\xf3n, se levanta una instancia EC2 sobre la que se instala ",(0,t.jsx)(n.strong,{children:"StrongSwan"})," para establecer t\xfaneles IPsec y ",(0,t.jsx)(n.strong,{children:"Nginx"})," como proxy (normalmente para enrutar tr\xe1fico en la capa de aplicaci\xf3n hacia un Application Load Balancer u otros recursos de la VPC)."]}),"\n",(0,t.jsx)(a.A,{overlayBgColorEnd:"rgba(255, 255, 255, 0.8)",children:(0,t.jsx)("img",{src:"/img/tutorials/third-party-integration-vpn/vpn-4.png",alt:"vpn-4"})}),"\n",(0,t.jsx)(n.h3,{id:"an\xe1lisis-de-costos-2",children:"An\xe1lisis de costos"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Hip\xf3tesis:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"3 t\xfaneles (VPN)"})," configurados en la misma instancia (o en dos instancias para redundancia)."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Instancia EC2"})," de tama\xf1o peque\xf1o, por ejemplo, ",(0,t.jsx)(n.strong,{children:"t3.small"})," (con costo aprox. 0.02\u20130.023 USD/h)."]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Costos:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"EC2 + EBS"}),": ~18\u201320 USD/mes (1 instancia)"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Transferencia de datos"}),": ~0.54 USD/mes"]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Suma total"}),": ~20\u201321 USD/mes (En caso de 2 instancias para HA => ~40\u201342 USD/mes.)"]}),"\n",(0,t.jsx)(n.p,{children:"Configuraci\xf3n de nginx y ipsec para lograr armar la conexi\xf3n."}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"nginx.conf"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-nginx",children:'load_module /usr/lib/nginx/modules/ngx_stream_module.so;\nworker_processes  1;\nerror_log  /var/log/nginx/error.log warn;\npid        /var/run/nginx.pid;\n\nevents {\n    worker_connections  1024;\n}\n\nhttp {\n    include       /etc/nginx/mime.types;\n    default_type  application/octet-stream;\n    log_format  main  \'$remote_addr - $remote_user [$time_local] "$request" \'\n                      \'$status $body_bytes_sent "$http_referer" \'\n                      \'"$http_user_agent" "$http_x_forwarded_for"\';\n    access_log  /var/log/nginx/access.log  main;\n    sendfile        on;\n    keepalive_timeout  65;\n    server_tokens off;\n}\n\nstream {\n    server {\n        listen 8180;\n        proxy_pass **<URL-ALB>**;\n    }\n}\n'})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"iptables.conf"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"*mangle\n:PREROUTING ACCEPT [8165:7991805]\n:INPUT ACCEPT [7883:7958068]\n:FORWARD ACCEPT [282:33737]\n:OUTPUT ACCEPT [5933:572312]\n:POSTROUTING ACCEPT [6215:606049]\nCOMMIT\n\n*nat\n:PREROUTING ACCEPT [159:9540]\n:INPUT ACCEPT [159:9540]\n:OUTPUT ACCEPT [168:10720]\n:POSTROUTING ACCEPT [168:10720]\n-A PREROUTING -i eth0 -p tcp -m tcp --dport 2222 -j DNAT --to-destination <IP-BIND>:22\n-A PREROUTING -i eth0 -p tcp -m tcp --dport 443 -j DNAT --to-destination <IP-BIND>:443\n-A POSTROUTING -p tcp -m tcp --dport 22 -j SNAT --to-source <IP-TUNNEL-BIND>\n-A POSTROUTING -p tcp -m tcp --dport 443 -j SNAT --to-source <IP-TUNNEL-BIND>\nCOMMIT\n\n*filter\n:INPUT ACCEPT [6016:538920]\n:FORWARD ACCEPT [123:22565]\n:OUTPUT ACCEPT [4614:432344]\n-A FORWARD -d <IP-BIND>/32 -p tcp -m tcp --dport 443 -m state --state NEW,RELATED,ESTABLISHED -j ACCEPT\n-A FORWARD -d <IP-BIND>/32 -p tcp -m tcp --dport 22 -m state --state NEW,RELATED,ESTABLISHED -j ACCEPT\n-A FORWARD -d <IP-BIND>/32 -p tcp -m tcp --dport 44301 -m state --state NEW,RELATED,ESTABLISHED -j ACCEPT\n-A FORWARD -d <IP-BIND>/32 -p tcp -m tcp --dport 22 -m state --state NEW,RELATED,ESTABLISHED -j ACCEPT\n-A FORWARD -d <IP-BIND>/32 -p tcp -m tcp --dport 8180 -m state --state NEW,RELATED,ESTABLISHED -j ACCEPT\nCOMMIT\n"})})]})}function g(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(h,{...e})}):h(e)}},26393:()=>{}}]);